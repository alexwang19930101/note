### 3.1 、部署

#### 3.1.1 、Zookeeper  正常部署

首先保证 Zookeeper 集群的正常部署，并启动之：
```
$ ~/modules/zookeeper-3.4.5/bin/zkServer.sh start
```
#### 3.1.2 、Hadoop  正常部署

Hadoop 集群的正常部署并启动：

```
$ ~/modules/hadoop-2.7.2/sbin/start-dfs.sh
$ ~/modules/hadoop-2.7.2/sbin/start-yarn.sh
```
#### 3.1.3 、HBase  的解压

解压 HBase 到指定目录：

```
$ tar -zxf ~/softwares/installations/hbase-1.3.1-bin.tar.gz -C ~/modules/
```
#### 3.1.4 、HBase  的配置文件

需要修改 HBase 对应的配置文件。
hbase-env.sh  修改内容：
```
export JAVA_HOME=/home/admin/modules/jdk1.8.0_121
export HBASE_MANAGES_ZK=false
```
hbase-site.xml  修改内容：
```xml
<configuration>
    <property>
        <name>hbase.rootdir</name>
        <value>hdfs://linux01:8020/hbase</value>
    </property>
    <property>
        <name>hbase.cluster.distributed</name>
        <value>true</value>
    </property>
    <!-- 0.98 后的新变动，之前版本没有.port,默认端口为 60000 -->
    <property>
        <name>hbase.master.port</name>
        <value>16000</value>
    </property>
    <property>
        <name>hbase.zookeeper.quorum</name>
        <value>linux01:2181,linux02:2181,linux03:2181</value>
    </property>
    <property>
        <name>hbase.zookeeper.property.dataDir</name>
        <value>/home/admin/modules/zookeeper-3.4.5/zkData</value>
    </property>
</configuration>
```
regionservers ：
```
linux01
linux02
linux03
```

#### 3.1.5 、HBase  需要依赖的 Jar  包

由于 HBase 需要依赖 Hadoop，所以替换 HBase 的 lib 目录下的 jar 包，以解决兼容问题：

1) 删除原有的 jar：
```sh
$ rm -rf /home/admin/modules/hbase-1.3.1/lib/hadoop-*
$ rm -rf /home/admin/modules/hbase-1.3.1/lib/zookeeper-3.4.6.jar
```
2) 拷贝新 jar，涉及的 jar 有：
```
hadoop-annotations-2.7.2.jar
hadoop-auth-2.7.2.jar
hadoop-client-2.7.2.jar
hadoop-common-2.7.2.jar
hadoop-hdfs-2.7.2.jar
hadoop-mapreduce-client-app-2.7.2.jar
hadoop-mapreduce-client-common-2.7.2.jar
hadoop-mapreduce-client-core-2.7.2.jar
hadoop-mapreduce-client-hs-2.7.2.jar
hadoop-mapreduce-client-hs-plugins-2.7.2.jar
hadoop-mapreduce-client-jobclient-2.7.2.jar
hadoop-mapreduce-client-jobclient-2.7.2-tests.jar
hadoop-mapreduce-client-shuffle-2.7.2.jar
hadoop-yarn-api-2.7.2.jar
hadoop-yarn-applications-distributedshell-2.7.2.jar
hadoop-yarn-applications-unmanaged-am-launcher-2.7.2.jar
hadoop-yarn-client-2.7.2.jar
hadoop-yarn-common-2.7.2.jar
hadoop-yarn-server-applicationhistoryservice-2.7.2.jar
hadoop-yarn-server-common-2.7.2.jar
hadoop-yarn-server-nodemanager-2.7.2.jar
hadoop-yarn-server-resourcemanager-2.7.2.jar
hadoop-yarn-server-tests-2.7.2.jar
hadoop-yarn-server-web-proxy-2.7.2.jar
zookeeper-3.4.5.jar
```

查找 jar 包举例：

```
$ find /home/admin/modules/hadoop-2.7.2/ -name hadoop-annotations*
```

然后将找到的 jar 包复制到 HBase 的 lib 目录下即可。

#### 3.1.6 、HBase  软连接 Hadoop  配置

```
$ ln -s ~/modules/hadoop-2.7.2/etc/hadoop/core-site.xml
~/modules/hbase-1.3.1/conf/core-site.xml
$ ln -s ~/modules/hadoop-2.7.2/etc/hadoop/hdfs-site.xml
~/modules/hbase-1.3.1/conf/hdfs-site.xml
```
#### 3.1.7 、HBase  远程 scp  到其他集群
```
$ scp -r /home/admin/modules/hbase-1.3.1/ linux02:/home/admin/modules/
$ scp -r /home/admin/modules/hbase-1.3.1/ linux03:/home/admin/modules/
```
#### 3.1.8 、HBase  服务的启动

启动方式 1 ：

```
$ bin/hbase-daemon.sh start master
$ bin/hbase-daemon.sh start regionserver
```

如果集群之间的节点时间不同步，会导致 regionserver 无法启动，抛出**`ClockOutOfSyncException`**异常。

启动方式 2 ：
```
$ bin/start-hbase.sh
```

对应的停止服务：

```
$ bin/stop-hbase.sh
```

 如 果 使 用 的 是 JDK8 以 上 版 本 ， 则 应 在 hbase-evn.sh 中 移除**`HBASE_MASTER_OPTS`** 和**`HBASE_REGIONSERVER_OPTS`**配置。

#### 3.1.9、查看 Hbse  页面

启动成功后，可以通过“host:port”的方式来访问 HBase 管理页面，例如：
**`http://linux01:16010`**