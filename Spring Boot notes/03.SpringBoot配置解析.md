# SpringBoot配置解析

## 1.配置文件

### 1.1 全局配置文件

Spring Boot会使用**src\main\resources**下的`application.properties`或`application.yml`作为全局配置文件以改变默认配置

properties没什么好说的

> “YAML Ain’t Markup Language” (abbreviated YAML) is a data
> serialization language designed to be human-friendly and work well with
> modern programming languages for common everyday tasks.

### 1.2 YAML使用

YAML使用缩进表示层级关系（一般为`空两格`，如果有多个并列的多值，使用`空两格-空一格`），key和value之间用**`:空格`**隔开，另外它对大小写敏感。

但是实际上YAML对缩进的空格数不敏感，可以根据需要调整。

```yaml
--- !<tag:clarkevans.com,2002:invoice>
invoice: 34843
date   : 2001-01-23
bill-to: &id001
    given  : Chris
    family : Dumars
    address:
        lines: |
            458 Walkman Dr.
            Suite #292
        city    : Royal Oak
        state   : MI
        postal  : 48046
ship-to: *id001
product:
    - sku         : BL394D
      quantity    : 4
      description : Basketball
      price       : 450.00
    - sku         : BL4438H
      quantity    : 1
      description : Super Hoop
      price       : 2392.00
tax  : 251.42
total: 4443.52
comments:
    Late afternoon is best.
    Backup contact is Nancy
    Billsmer @ 338-4338.
```

YAML的value可以是字面量，对象（map），数组

**字面量**：直接写默认不加上单引号或是双引号。

​	`“”双引号`转译特殊字符

​	`‘’单引号`不转译特殊字符

**对象**：最好换行缩进

```yaml
Mark McGwire: {hr: 65, avg: 0.278}

name: Mark McGwire
hr  : 65
avg : 0.278
```

**数组**：

```yaml
product:
    - sku         : BL394D
      quantity    : 4
      description : Basketball
      price       : 450.00
    - sku         : BL4438H
      quantity    : 1
      description : Super Hoop
      price       : 2392.00
```



## 2.加载顺序

Spring Boot会按照下列顺序来查找配置文件,在找到之後後面的通配置项会被覆盖

1. `file: ./config/`
2. `file: ./`
3. `classpath: ./config/`
4. `classpath: ./`



## 3.重要的注解

见附录



## 4.自动配置原理

在第二章中实际已经将关键的代码与调试做了，这里在明白了配置文件后再来看一遍。

见附录自动配置原理



## 5.profile多环境配置

### 5.1 使用properties文件

![1564155263909](C:\Users\wxy\Documents\GitNote\note\Spring Boot notes\springboot相关图片\1564155263909.png)

默认使用application.properties

用spring.profiles.active来激活各个环境，文件名为application-{profile}.properties

![1564155423308](C:\Users\wxy\Documents\GitNote\note\Spring Boot notes\springboot相关图片\1564155423308.png)

### 5.2 使用yaml文件

这里的yaml配置是4块，但是由于之前的application-prod.properties没有注释掉导致使用了之前的配置

![1564156190351](C:\Users\wxy\Documents\GitNote\note\Spring Boot notes\springboot相关图片\1564156190351.png)

注释后再尝试，完成目的效果

![1564156307094](C:\Users\wxy\Documents\GitNote\note\Spring Boot notes\springboot相关图片\1564156307094.png)

### 5.3 使用命令行

```shell
java -jar xxx.jar --spring.profiles.active=dev
```